<?xml version="1.0"?>
<!DOCTYPE wizard-schema PUBLIC "-//MMBase/DTD editwizard 1.0//EN" "http://www.mmbase.org/dtd/wizard-schema_1_0.dtd">
<wizard-schema id="edit-page">
	<title>Pagina</title>
	<task-description>Use this wizard to edit a page.</task-description>
	
	<action include="wizards/pages/create_pages.xml" />
	
	<action include="wizards/pages/delete_pages.xml" />

	<action type="load">
		<relation destination="templates" role="related" />
		<relation destination="pages" role="posrel" />
		<relation destination="articles" role="posrel" />
		<relation destination="urls" role="posrel" />
	</action>

	<steps>
		<step form-schema="edit_page" />
		<step form-schema="news" />
		<step form-schema="template" />
	</steps>
	
	<form-schema id="edit_page">
		<title>Pagina</title>
		<field name="title" dtminlength="1" dtmaxlength="100">
			<prompt>Paginatitel</prompt>
			<description>De naam of de titel van de pagina</description>
		</field>
		<field name="menuname" dtmaxlength="100">
			<prompt>Subtitel (bv. naam van het project)</prompt>
			<description></description>
		</field>
	</form-schema>
	<form-schema id="news">
		<title>Artikelen en URLs</title>
		<field name="title" ftype="data">
			<prompt>Paginatitel</prompt>
			<description>De naam of de titel van de pagina</description>
		</field>
		<list include="wizards/articles/add_articles_posrel.xml" />
		<!-- urls -->
		<list role="posrel" destination="urls" minoccurs="0" maxoccurs="*">
			<title>Urls (downloadable file on pos 1, the licenses on &gt; 1)</title>
			<description></description>
		
			<command name="search" nodepath="urls" fields="url,description" age="-1">
				<prompt></prompt>
				<search-filter>
						<name>Url bevat</name>
						<search-fields>url</search-fields>
				</search-filter>
				<search-filter>
						<name>Omschrijving bevat</name>
						<search-fields>description</search-fields>
				</search-filter>
			</command>
			<command name="startwizard" inline="true" wizardname="wizards/urls/urls" objectnumber="new"/>
		
			<item>
				<title></title>
				<description></description>
				<field name="url" ftype="data" >
					<prompt>Url</prompt>
				</field>
				<field name="description" ftype="data" >
					<prompt>Beschrijving</prompt>
				</field>
				<field fdatapath="field[@name=&apos;pos&apos;]" ftype="line"><prompt>Positie</prompt></field>
				<field fdatapath="." ftype="startwizard" inline="true" objectnumber="{object/@number}" wizardname="wizards/urls/urls">
					<prompt></prompt>
				</field>
			</item>
		
			<action type="create">
				<relation role="posrel">
					<object type="urls" />
					<field name="pos">{sum(//relation[@role=&apos;posrel&apos; and @lastitem=&apos;true&apos;]/field[@name=&apos;pos&apos;])+{$pos}}</field>
				</relation>
			</action>
		</list>
		<!-- einde urls -->
	</form-schema>
	<form-schema id="template">
		<title>Stramien</title>
		<field name="title" ftype="data">
			<prompt>Paginatitel</prompt>
			<description>De naam of de titel van de pagina</description>
		</field>
		<list include="wizards/templates/add_templates.xml" />
		<list include="wizards/pages/add_subpages_posrel.xml" />
	</form-schema>

</wizard-schema>
